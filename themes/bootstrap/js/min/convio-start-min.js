!function($){luminateExtend({apiKey:"sosapikey",path:{nonsecure:"https://secure.nokidhungry.org/site/",secure:"https://secure.nokidhungry.org/site/"}}),$(function(){$(".donation-form").length>0&&(luminateExtend.api.request({api:"CRDonationAPI",data:"method=getDonationFormInfo&form_id="+formId,callback:function(e){var r=$("#donation_level");r.empty();var o="";if(e.getDonationFormInfoResponse.donationLevels&&e.getDonationFormInfoResponse.donationLevels.donationLevel.length>0)for(var t=0;t<e.getDonationFormInfoResponse.donationLevels.donationLevel.length;t++){var n=e.getDonationFormInfoResponse.donationLevels.donationLevel[t],s=n.amount.formatted;o+="true"===n.userSpecified?'<div class="radio-wrap wrap-amount"><input type="radio" id="level-other" name="level_id" value="'+n.level_id+'"><label class="donation_amount donation_amount_other " for="level-other"> Other </label></div><div  id="wrap-amount_other" style="display: none"><input type="text" id="other-amount" class="other-amount" name="other_amount" disabled></div>':'<div class="radio-wrap wrap-amount"><input type="radio" id="'+n.level_id+'" name="level_id" value="'+n.level_id+'"> <label class="donation_amount" for="'+n.level_id+'" >'+s.substr(0,n.amount.length-3)+"</label></div>"}r.html(o)}}),$("body").on("click",'input[name="level_id"]',function(){$(this).is("#level-other")?($("#other-amount").removeAttr("disabled"),$("#other-amount").attr("name","other_amount"),$("#other-amount").focus(),$("#wrap-amount_other").css("display","inline-block")):($("#other-amount").attr("disabled","disabled"),$("#other-amount").removeAttr("name"),$("#wrap-amount_other").css("display","none"))}),$(".donation-form").submit(function(){window.scrollTo(0,0),$("#form_id").val(formId),$(this).hide(),$(this).before('<div class="well donation-loading">Loading ...</div>')})),window.donateCallback={error:function(e){$("#donation-errors").remove(),$(".donation-form").prepend('<div id="donation-errors"><div class="alert alert-danger">'+e.errorResponse.message+"</div></div>"),$(".donation-loading").remove(),$(".donation-form").show()},success:function(e){if($("#donation-errors").remove(),e.donationResponse.errors){if($(".donation-form").prepend('<div id="donation-errors">'+(e.donationResponse.errors.message?'<div class="alert alert-danger">'+e.donationResponse.errors.message+"</div>":"")+"</div>"),e.donationResponse.errors.fieldError){var r=luminateExtend.utils.ensureArray(e.donationResponse.errors.fieldError);$.each(r,function(){$("#donation-errors").append('<div class="alert alert-danger">'+this+"</div>")})}$(".donation-loading").remove(),$(".donation-form").show()}else $(".donation-loading").remove(),$(".donation-form").before('<div class="alert alert-success">Your donation has been processed!</div><div class="well"><p>Thank you for your donation of $'+e.donationResponse.donation.amount.decimal+".</p><p>Your confirmation code is "+e.donationResponse.donation.confirmation_code+".</p></div>")}},$(".survey-form").length>0&&(luminateExtend.api.request({api:"CRSurveyAPI",data:"method=getSurvey&survey_id="+surveyId,requestType:"POST",requiresAuth:!0,callback:function(e){if(e.errorResponse&&e.errorResponse.message)$(".survey-form").prepend('<div id="survey-errors"><div class="alert alert-danger">'+e.errorResponse.message+"</div></div>");else if(e.getSurveyResponse.survey.surveyQuestions&&e.getSurveyResponse.survey.surveyQuestions.length>0){var r=$("#survey-content");r.empty();for(var o="",t=0;t<e.getSurveyResponse.survey.surveyQuestions.length;t++){var n=e.getSurveyResponse.survey.surveyQuestions[t],s="question_"+n.questionId,i="true"==n.questionRequired?'<span class="required"> *</span>':"";o+="false"==n.hidden?'<div><label for="survey-'+s+'">'+n.questionText+i+'</label><div><input type="text" name="'+s+'" id="survey-'+s+'" data-convio-text="'+n.questionText+'"/></div></div>':'<input type="hidden" id="'+s+'" name="'+s+'" value="">'}r.html(o)}}}),$("#survey_id").val(surveyId),$(".survey-form").submit(function(e){e.preventDefault(),$(this).attr("id")||$(this).attr("id","luminateApi-"+(new Date).getTime());var r=$(this).attr("action"),o=r.split("?"),t=$(this).data("luminateapi"),n=-1!=o[0].indexOf("/site/")?o[0].split("/site/")[1]:o[0],s,i=$(this).attr("enctype"),a=o.length>1?o[1]:"",d="#"+$(this).attr("id"),u=$(this),l=null;$("[data-convio-text]").each(function(){var e=$(this).data("convio-text").toLowerCase().split(" ").join("_");"email"==e?l=$(this).val():$("<input />").attr("type","hidden").attr("name","cons_"+e).attr("value",$(this).val()).appendTo(u)}),t&&(t.callback&&(s=luminateExtend.utils.stringToObj(t.callback)),t.requiresAuth&&"true"==t.requiresAuth&&(requestRequiresAuth=!0),(0==r.indexOf("https:")||"https:"==window.location.protocol&&-1==r.indexOf("http"))&&(requestUseHTTPS=!0));var v=function(e,r){e&&uminateExtend.global.update({auth:{token:e,type:"auth"}}),r&&$("<input />").attr("type","hidden").attr("name","cons_id").attr("value",r).appendTo(u),luminateExtend.api.request({api:n,callback:submitSurveyCallback,contentType:i,data:a,form:d,requestType:"POST",requiresAuth:!0,useHTTPS:!0})},p=function(e){$("#survey-errors").remove(),$(".survey-form .form-group .alert").remove(),u.prepend('<div id="survey-errors"><div class="alert alert-danger">'+("string"==typeof e?e:e.errorResponse.message)+"</div></div>"),$(".survey-loading").remove(),u.show()};return l?(window.scrollTo(0,0),$(this).hide(),$(this).before('<div class="well survey-loading">Loading ...</div>'),void luminateExtend.api.request({api:"cons",callback:{success:function(e){console.log("SUCCESS"),v(e.createConsResponse.token)},error:function(e){e.errorResponse&&11==e.errorResponse.code?luminateExtend.api({api:"cons",callback:{success:function(e){console.log(e.loginResponse.token)},error:function(e){console.log("SOMETHINGS ERROR")}},data:"method=authenticateUser",requestType:"POST"}):p(e)}},data:"method=create&primary_email="+l+"&get_single_sign_on_token=true",requestType:"POST",requiresAuth:!0})):void p("Email required")})),window.submitSurveyCallback={error:function(e){$("#survey-errors").remove(),$(".survey-form .form-group .alert").remove(),$(".survey-form").prepend('<div id="survey-errors"><div class="alert alert-danger">'+e.errorResponse.message+"</div></div>"),$(".survey-loading").remove(),$(".survey-form").show()},success:function(e){if($("#survey-errors").remove(),$(".survey-form .form-group .survey-alert-wrap").remove(),"false"==e.submitSurveyResponse.success){$(".survey-form").prepend('<div id="survey-errors"><div class="alert alert-danger">'+(e.submitSurveyResponse.errors?e.submitSurveyResponse.errors.errorMessage:"There was an error with your submission. Please try again.")+"</div></div>");var r=luminateExtend.utils.ensureArray(e.submitSurveyResponse.errors);$.each(r,function(){this.errorField&&$('input[name="'+this.errorField+'"]').closest("div").prepend('<div class="survey-alert-wrap"><div class="alert alert-danger">'+this.errorMessage+"</div></div>")}),$(".survey-loading").remove(),$(".survey-form").show()}else $(".survey-loading").remove(),$(".survey-form").before('<div class="alert alert-success">You\'ve been signed up!</div><div class="well"><p>Thanks for joining. You should receive your first issue of the e-newsletter shortly.</p></div>')}},luminateExtend.api.bind()})}(jQuery);